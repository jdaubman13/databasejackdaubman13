-- Question 1
SELECT AVG(POWER) AS "AVG_POWER", MAX(POWER) AS "MAX_POWER", MIN(POWER) AS "MIN_POWER"
FROM STAND_USER;

-- Question 2 
SELECT COUNT(PRECISION) AS "KNOWN_PRECISION", COUNT(*) AS "TOTAL_USERS"
FROM STAND_USER;

-- Question 3
SELECT ROUND(STDDEV(POWER), 3) AS "STDDEV_POWER", ROUND(VARIANCE(POWER), 3) AS "VARIANCE_POWER"
FROM STAND_USER;

-- Question 4 
SELECT PRECISION, ROUND(AVG(POWER), 3) AS AVG_POWER 
FROM STAND_USER
WHERE PRECISION IS NOT NULL
GROUP BY PRECISION;

-- Question 5
SELECT PRECISION, AVG(POWER) AS "AVG_POWER"
FROM STAND_USER
WHERE PRECISION IS NOT NULL
HAVING AVG(POWER) > 80
GROUP BY PRECISION;

-- Question 6
SELECT USER_NAME, STAND_NAME, ROUND(POWER - (SELECT AVG(POWER) FROM STAND_USER), 3) AS diff_from_avg
FROM STAND_USER
ORDER BY diff_from_avg DESC;

-- Question 7 
SELECT ROUND(AVG(POWER), 2) AS "ROUNDED_AVG_POWER"
FROM STAND_USER;

-- Qestion 8 
SELECT PRECISION, SUM(POWER) AS "TOTAL_POWER"
FROM STAND_USER
GROUP BY ROLLUP(PRECISION);

-- Question 9 
SELECT EXTRACT(YEAR FROM debut_date) AS debut_year,
       precision,
       SUM(power) AS total_power
FROM stand_user
GROUP BY CUBE(EXTRACT(YEAR FROM debut_date), precision)
ORDER BY debut_year, precision;
 
